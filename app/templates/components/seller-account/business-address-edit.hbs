<div class="cool-infobox sapphire">
  {{fa-icon "info-circle" size="2x" prefix="fas"}}
  Please note that all fields are mandatory unless otherwise indicated.
</div>
<h4>Head office</h4>
<p>This is the business address of your head office.</p>
{{#if (eq form.apiErrors.addresses "Changes requested upon your previous submission")}}
  {{dds/validation-error type="warning" message=form.apiErrors.addresses isSimple=true class="error"}}
{{/if}}
{{#each form.addresses as |address index|}}
  {{#let (get form.apiErrors.addresses index) as |apiError|}}
    {{dds/text-input
      isSimple=true
      label-text="Business address"
      field=(mut address.address)
      required=true
      showError=(or showError (not-eq form.status 'todo'))
      apiError=apiError.address
    }}
    
    {{dds/text-input
      isSimple=true
      noLabel=true
      field=(mut address.address_2)
      apiError=apiError.address_2
      showError=(or showError (not-eq form.status 'todo'))
    }}
    
    {{dds/text-input
      isSimple=true
      noLabel=true
      field=(mut address.address_3)
      apiError=apiError.address_3
      showError=(or showError (not-eq form.status 'todo'))
    }}
          
    <div class="row">
      {{dds/text-input
        isSimple=true
        label-text="Suburb or town"
        class="col-sm-27"
        field=(mut address.suburb)
        required=true
        showError=(or showError (not-eq form.status 'todo'))
        apiError=apiError.suburb
      }}

      {{dds/text-input
        isSimple=true
        label-text="Postcode or ZIP"
        class="col-sm-9"
        field=(mut address.postcode)
        required=true
        showError=(or showError (not-eq form.status 'todo'))
        signal=form.signal
        apiError=apiError.postcode
      }}
    </div>

    <div class="row">
      {{dds/select-box
        field=(mut address.state)
        label-text="State or territory"
        class="col-sm-18"
        items=(array
          (hash value="nsw" label="New South Wales")
          (hash value="act" label="Australian Capital Territory")
          (hash value="nt" label="Northern Territory")
          (hash value="qld" label="Queensland")
          (hash value="sa" label="South Australia")
          (hash value="tas" label="Tasmania")
          (hash value="vic" label="Victoria")
          (hash value="wa" label="Western Australia")
          (hash value="outside_au" label="Outside Australia")
        )
        required=true
        showError=(or showError (not-eq form.status 'todo'))
        apiError=apiError.state
      }}
      
      {{dds/select-box
        field=(mut address.country)
        label-text="Country"
        class="col-sm-18"
        items=countries
        required=true
        showError=(or showError (not-eq form.status 'todo'))
        signal=form.signal
        apiError=apiError.country
      }}
    </div>
    {{#if (eq index 0)}}
      <br>
      {{#if form.headOfficeAustralia}}
        <h4>Corporate structure</h4>
        {{dds/radio-group
          isSimple=true
          class="sapphire-radios"
          items=(array
            (hash
              key="standalone"
              label="An Australian company that is not a subsidiary of another company"
            )
            (hash
              key="subsidiary"
              label="A locally-based company that is a subsidiary of a multinational corporation"
            )
          )
          field=(mut form.corporate_structure)
          showError=(or showError (not-eq form.status 'todo'))
          invalid=(v-get form 'corporate_structure' 'isInvalid')
          errorMessage=(v-get form 'corporate_structure' 'message')
          apiError=form.apiErrors.corporate_structure
        }}
      {{/if}}
      {{#if form.headOfficeRegional}}
        {{dds/checkbox-input
          isSimple=true
          field=(mut form.regional)
          apiError=form.apiErrors.regional
          showError=(or showError (not-eq form.status 'todo'))
          label="Regional"
          description=(if form.can_be_regional "It looks like your head office is located in regional NSW. Would you like to identify your business as a regional NSW supplier?" "To be classified as NSW Regional business your head office must be in regional NSW.")
        }}
      {{/if}}
    {{/if}}
    {{#if (gt index 0)}}
      {{dds/tertiary-button
        label="Discard this address"
        onClick=(action "removeAddress" index)
      }}
    {{/if}}
      {{dds/top-link}}
    {{#if (or (eq index 0) (lt index (dec form.addresses.length)))}}
      <hr />
    {{/if}}
    {{#if (eq index 0)}}
      <h4>Additional locations</h4>
      <p>List any additional business locations in Australia.</p>
    {{/if}}
  {{/let}}
{{/each}}
{{#if (lt form.addresses.length 6)}}
  {{dds/tertiary-button
    label="Add an address"
    onClick=(action "addAddress")
  }}
{{/if}}